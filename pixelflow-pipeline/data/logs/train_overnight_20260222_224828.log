================================================================
  NNUE Guide Overnight Training Pipeline
  Started: Sun Feb 22 22:48:28 EST 2026
  Log: /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/logs/train_overnight_20260222_224828.log
================================================================

Configuration:
  Collection: 500 expressions, 3 perturbations
  Training: 80 epochs, batch=128, lr=3e-4
  Output: /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/guide_v2.bin

================================================================
  Stage 1: Collecting replay buffer
  Sun Feb 22 22:48:28 EST 2026
================================================================
Building collector...

warning: `pixelflow-pipeline` (lib) generated 19 warnings (run `cargo fix --lib -p pixelflow-pipeline` to apply 16 suggestions)
    Finished `release` profile [optimized] target(s) in 2.47s

Running collection...
warning: unused variable: `mantissa_bits`
  --> pixelflow-ir/src/backend/compounds.rs:74:13
   |
74 |         let mantissa_bits = Self::from_bits(0x3F800000); // 1.0
   |             ^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_mantissa_bits`
   |
   = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `mantissa_mask`
  --> pixelflow-ir/src/backend/compounds.rs:75:13
   |
75 |         let mantissa_mask = Self::from_bits(0x007FFFFF);
   |             ^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_mantissa_mask`

warning: unused variable: `scratch`
   --> pixelflow-ir/src/backend/emit/aarch64.rs:351:62
    |
351 | pub fn emit_sin_poly(code: &mut Vec<u8>, dst: Reg, src: Reg, scratch: [Reg; 4]) {
    |                                                              ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_scratch`

warning: unused variable: `scratch`
   --> pixelflow-ir/src/backend/emit/aarch64.rs:358:62
    |
358 | pub fn emit_cos_poly(code: &mut Vec<u8>, dst: Reg, src: Reg, scratch: [Reg; 4]) {
    |                                                              ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_scratch`

warning: unused variable: `scratch`
   --> pixelflow-ir/src/backend/emit/aarch64.rs:364:62
    |
364 | pub fn emit_exp_poly(code: &mut Vec<u8>, dst: Reg, src: Reg, scratch: [Reg; 4]) {
    |                                                              ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_scratch`

warning: unused variable: `scratch`
   --> pixelflow-ir/src/backend/emit/aarch64.rs:370:63
    |
370 | pub fn emit_exp2_poly(code: &mut Vec<u8>, dst: Reg, src: Reg, scratch: [Reg; 4]) {
    |                                                               ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_scratch`

warning: unused variable: `scratch`
   --> pixelflow-ir/src/backend/emit/aarch64.rs:376:61
    |
376 | pub fn emit_ln_poly(code: &mut Vec<u8>, dst: Reg, src: Reg, scratch: [Reg; 4]) {
    |                                                             ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_scratch`

warning: unused variable: `scratch`
   --> pixelflow-ir/src/backend/emit/aarch64.rs:382:63
    |
382 | pub fn emit_log2_poly(code: &mut Vec<u8>, dst: Reg, src: Reg, scratch: [Reg; 4]) {
    |                                                               ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_scratch`

warning: unused variable: `code`
   --> pixelflow-ir/src/backend/emit/aarch64.rs:392:22
    |
392 | pub fn emit_prologue(code: &mut Vec<u8>) {
    |                      ^^^^ help: if this is intentional, prefix it with an underscore: `_code`

warning: unused variable: `scratch`
   --> pixelflow-ir/src/backend/emit/x86_64.rs:174:71
    |
174 | pub fn emit_unary(code: &mut Vec<u8>, op: OpKind, dst: Reg, src: Reg, scratch: [Reg; 4]) {
    |                                                                       ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_scratch`

warning: function `emit_vex_128_0f` is never used
  --> pixelflow-ir/src/backend/emit/x86_64.rs:14:4
   |
14 | fn emit_vex_128_0f(code: &mut Vec<u8>, opcode: u8, dst: Reg, src1: Reg, src2: Reg) {
   |    ^^^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: `extern` fn uses type `std::arch::aarch64::float32x4_t`, which is not FFI-safe
   --> pixelflow-ir/src/backend/emit/executable.rs:138:21
    |
138 | pub type KernelFn = extern "C" fn(float32x4_t, float32x4_t, float32x4_t, float32x4_t) -> float32x4_t;
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
    |
    = help: consider adding a `#[repr(C)]` or `#[repr(transparent)]` attribute to this struct
    = note: this struct has unspecified layout
    = note: `#[warn(improper_ctypes_definitions)]` on by default

warning: `pixelflow-ir` (lib) generated 12 warnings (run `cargo fix --lib -p pixelflow-ir` to apply 10 suggestions)
warning: `pixelflow-ir` (lib) generated 12 warnings (12 duplicates)
warning: unused import: `alloc::boxed::Box`
  --> pixelflow-search/src/search/mod.rs:27:5
   |
27 | use alloc::boxed::Box;
   |     ^^^^^^^^^^^^^^^^^
   |
   = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: unused import: `StructuralFeatures`
  --> pixelflow-search/src/search/mod.rs:29:46
   |
29 | use crate::nnue::factored::{EdgeAccumulator, StructuralFeatures, EMBED_DIM};
   |                                              ^^^^^^^^^^^^^^^^^^

warning: unused import: `alloc::vec::Vec`
 --> pixelflow-search/src/search/strategy.rs:5:5
  |
5 | use alloc::vec::Vec;
  |     ^^^^^^^^^^^^^^^

warning: unused imports: `ActionScore`, `StateEmbedding`, and `TrajectoryStep`
  --> pixelflow-search/src/search/strategy.rs:9:47
   |
 9 |     SearchStrategy, SearchResult, Trajectory, TrajectoryStep,
   |                                               ^^^^^^^^^^^^^^
10 |     ActionScore, StateEmbedding, StopReason, Evaluator,
   |     ^^^^^^^^^^^  ^^^^^^^^^^^^^^

warning: unused import: `alloc::vec::Vec`
 --> pixelflow-search/src/search/eval.rs:6:5
  |
6 | use alloc::vec::Vec;
  |     ^^^^^^^^^^^^^^^

warning: unused import: `EMBED_DIM`
 --> pixelflow-search/src/search/eval.rs:8:35
  |
8 | use crate::nnue::{ExprNnue, Expr, EMBED_DIM};
  |                                   ^^^^^^^^^

warning: unused imports: `MaskMlpGrad` and `ValueMlpGrad`
 --> pixelflow-search/src/search/gradient.rs:8:54
  |
8 | use super::{GradientSignal, Gradients, SearchResult, MaskMlpGrad, ValueMlpGrad};
  |                                                      ^^^^^^^^^^^  ^^^^^^^^^^^^

warning: unused variable: `node`
   --> pixelflow-search/src/egraph/nnue_adapter.rs:264:23
    |
264 |             for (idx, node) in nodes.iter().enumerate() {
    |                       ^^^^ help: if this is intentional, prefix it with an underscore: `_node`
    |
    = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: variable does not need to be mutable
   --> pixelflow-search/src/mcts/search.rs:247:13
    |
247 |         let mut logits: Vec<f32> = self.available_actions
    |             ----^^^^^^
    |             |
    |             help: remove this `mut`
    |
    = note: `#[warn(unused_mut)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `scale_embed`
    --> pixelflow-search/src/nnue/factored.rs:1414:13
     |
1414 |         let scale_embed = sqrtf(2.0 / EMBED_DIM as f32);
     |             ^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_scale_embed`

warning: unreachable pattern
   --> pixelflow-search/src/nnue/mod.rs:428:31
    |
428 | ...   (Expr::Param(i), _) | (_, Expr::Param(i)) => panic!("Expr::Param({}) reached NNUE cost model — call substitute_params before use", i),
    |                             ^^^^^^^^^^^^^^^^^^^ no value can reach this
    |
note: multiple earlier patterns match some of the same values
   --> pixelflow-search/src/nnue/mod.rs:428:31
    |
426 | ...   (Expr::Var(_), _) | (Expr::Const(_), _) | (Expr::Unary(_, _), _) |
    |       -----------------   -------------------   ---------------------- matches some of the same values
    |       |                   |
    |       |                   matches some of the same values
    |       matches some of the same values
427 | ...   (Expr::Binary(_, _, _), _) | (Expr::Ternary(_, _, _, _), _) | (Expr::Nary(_, _), _) => false,
    |       -------------------------- matches some of the same values
428 | ...   (Expr::Param(i), _) | (_, Expr::Param(i)) => panic!("Expr::Param({}) reached NNUE cost model — call substitute_params before use", i),
    |                             ^^^^^^^^^^^^^^^^^^^ ...and 3 other patterns collectively make this unreachable
    = note: `#[warn(unreachable_patterns)]` (part of `#[warn(unused)]`) on by default

warning: unreachable pattern
    --> pixelflow-search/src/nnue/mod.rs:1401:31
     |
1401 | ...   (Expr::Param(i), _) | (_, Expr::Param(i)) => panic!("Expr::Param({}) reached NNUE cost model — call substitute_params before use", i),
     |                             ^^^^^^^^^^^^^^^^^^^ no value can reach this
     |
note: multiple earlier patterns match some of the same values
    --> pixelflow-search/src/nnue/mod.rs:1401:31
     |
1399 | ...   (Expr::Var(_), _) | (Expr::Const(_), _) | (Expr::Unary(_, _), _) |
     |       -----------------   -------------------   ---------------------- matches some of the same values
     |       |                   |
     |       |                   matches some of the same values
     |       matches some of the same values
1400 | ...   (Expr::Binary(_, _, _), _) | (Expr::Ternary(_, _, _, _), _) | (Expr::Nary(_, _), _) => false,
     |       -------------------------- matches some of the same values
1401 | ...   (Expr::Param(i), _) | (_, Expr::Param(i)) => panic!("Expr::Param({}) reached NNUE cost model — call substitute_params before use", i),
     |                             ^^^^^^^^^^^^^^^^^^^ ...and 3 other patterns collectively make this unreachable

warning: unused variable: `rule_embeds`
   --> pixelflow-search/src/search/strategy.rs:133:9
    |
133 |         rule_embeds: &[[f32; EMBED_DIM]],
    |         ^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_rule_embeds`

warning: unused variable: `rule_embeds`
   --> pixelflow-search/src/search/strategy.rs:175:9
    |
175 |         rule_embeds: &[[f32; EMBED_DIM]],
    |         ^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_rule_embeds`

warning: unused variable: `results`
  --> pixelflow-search/src/search/gradient.rs:66:9
   |
66 |         results: &[SearchResult],
   |         ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_results`

warning: unused variable: `rule_embeds`
  --> pixelflow-search/src/search/gradient.rs:68:9
   |
68 |         rule_embeds: &[[f32; EMBED_DIM]],
   |         ^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_rule_embeds`

warning: unused variable: `rule_embeds`
   --> pixelflow-search/src/search/gradient.rs:117:9
    |
117 |         rule_embeds: &[[f32; EMBED_DIM]],
    |         ^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_rule_embeds`

warning: unused variable: `advantages`
   --> pixelflow-search/src/search/gradient.rs:142:13
    |
142 |         let advantages: Vec<f32> = rewards.iter()
    |             ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_advantages`

warning: field `seed` is never read
  --> pixelflow-search/src/search/strategy.rs:63:5
   |
57 | pub struct BestFirstSearch {
   |            --------------- field in this struct
...
63 |     seed: u64,
   |     ^^^^
   |
   = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: method `rand` is never used
  --> pixelflow-search/src/search/strategy.rs:71:8
   |
66 | impl BestFirstSearch {
   | -------------------- method in this implementation
...
71 |     fn rand(&mut self) -> f32 {
   |        ^^^^

warning: field `seed` is never read
   --> pixelflow-search/src/search/strategy.rs:114:5
    |
104 | pub struct FilteredSearch {
    |            -------------- field in this struct
...
114 |     seed: u64,
    |     ^^^^

warning: method `rand` is never used
   --> pixelflow-search/src/search/strategy.rs:122:8
    |
117 | impl FilteredSearch {
    | ------------------- method in this implementation
...
122 |     fn rand(&mut self) -> f32 {
    |        ^^^^

   Compiling pixelflow-core v0.1.0 (/Users/jppittman/Documents/Projects/core-term/pixelflow-core)
warning: `pixelflow-search` (lib) generated 22 warnings (run `cargo fix --lib -p pixelflow-search` to apply 16 suggestions)
warning: unused import: `CallExpr`
  --> pixelflow-compiler/src/annotate.rs:22:39
   |
22 | use crate::ast::{BinaryOp, BlockExpr, CallExpr, Expr, IdentExpr, Stmt, UnaryOp};
   |                                       ^^^^^^^^
   |
   = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: unused imports: `BinaryExpr`, `BlockExpr`, `CallExpr`, `IdentExpr`, `LiteralExpr`, `MethodCallExpr`, and `UnaryExpr`
  --> pixelflow-compiler/src/fold.rs:26:18
   |
26 | use crate::ast::{BinaryExpr, BinaryOp, BlockExpr, CallExpr, Expr, IdentExpr, LiteralExpr, MethodCallExpr, Stmt, UnaryExpr, UnaryOp};
   |                  ^^^^^^^^^^            ^^^^^^^^^  ^^^^^^^^        ^^^^^^^^^  ^^^^^^^^^^^  ^^^^^^^^^^^^^^        ^^^^^^^^^

warning: unused imports: `BinaryExpr` and `LiteralExpr`
  --> pixelflow-compiler/src/ir_bridge.rs:11:18
   |
11 | use crate::ast::{BinaryExpr, BinaryOp, Expr, LiteralExpr, UnaryOp};
   |                  ^^^^^^^^^^                  ^^^^^^^^^^^

warning: unused import: `Span`
  --> pixelflow-compiler/src/ir_bridge.rs:14:19
   |
14 | use proc_macro2::{Span, TokenStream};
   |                   ^^^^

warning: unused import: `Ident`
  --> pixelflow-compiler/src/ir_bridge.rs:17:11
   |
17 | use syn::{Ident, Lit};
   |           ^^^^^

warning: unused imports: `GenericParam`, `Generics`, and `parse_quote`
  --> pixelflow-compiler/src/manifold_expr.rs:27:11
   |
27 | use syn::{parse_quote, DeriveInput, GenericParam, Generics};
   |           ^^^^^^^^^^^               ^^^^^^^^^^^^  ^^^^^^^^

warning: unused import: `CallExpr`
  --> pixelflow-compiler/src/optimize.rs:26:38
   |
26 |     BinaryExpr, BinaryOp, BlockExpr, CallExpr, Expr, IdentExpr, LetStmt, LiteralExpr, MethodCallExpr, Stmt,
   |                                      ^^^^^^^^

warning: unused imports: `egraph_to_ir` and `ir_to_code`
  --> pixelflow-compiler/src/optimize.rs:30:35
   |
30 | use crate::ir_bridge::{ast_to_ir, egraph_to_ir, ir_to_code, IRToEGraphContext};
   |                                   ^^^^^^^^^^^^  ^^^^^^^^^^

warning: unused import: `Duration`
  --> pixelflow-compiler/src/optimize.rs:42:17
   |
42 | use std::time::{Duration, Instant};
   |                 ^^^^^^^^

warning: unused import: `pixelflow_search::egraph::RewriteTarget`
   --> pixelflow-compiler/src/optimize.rs:105:9
    |
105 |     use pixelflow_search::egraph::RewriteTarget;
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused variable: `type_str`
   --> pixelflow-compiler/src/codegen/emitter.rs:510:25
    |
510 |                     let type_str = quote!{ #domain }.to_string();
    |                         ^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_type_str`
    |
    = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `at_manifold_params`
   --> pixelflow-compiler/src/codegen/emitter.rs:648:40
    |
648 |         fn emit_unified_binding(&self, at_manifold_params: &HashSet<String>, scalar_type: &TokenStream) -> (TokenStream, TokenStream) {
    |                                        ^^^^^^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_at_manifold_params`

warning: unused variable: `needs_pre_eval`
   --> pixelflow-compiler/src/codegen/emitter.rs:661:17
    |
661 |             let needs_pre_eval = manifold_count > 0 &&
    |                 ^^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_needs_pre_eval`

warning: unused variable: `root_deps`
   --> pixelflow-compiler/src/codegen/leveled.rs:400:9
    |
400 |     let root_deps = builder.get_deps(root);
    |         ^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_root_deps`

warning: unused variable: `iteration`
   --> pixelflow-compiler/src/optimize.rs:155:9
    |
155 |     for iteration in 0..config.max_expansions {
    |         ^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_iteration`

warning: unused variable: `ty`
   --> pixelflow-compiler/src/parser.rs:166:15
    |
166 |     if let Ok(ty) = fork.parse::<Type>() {
    |               ^^ help: if this is intentional, prefix it with an underscore: `_ty`

warning: method `literal_count` is never used
  --> pixelflow-compiler/src/annotate.rs:40:12
   |
34 | impl AnnotationCtx {
   | ------------------ method in this implementation
...
40 |     pub fn literal_count(&self) -> usize {
   |            ^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: field `span` is never read
  --> pixelflow-compiler/src/annotate.rs:65:9
   |
63 | pub struct AnnotatedTuple {
   |            -------------- field in this struct
64 |     pub elems: Vec<AnnotatedExpr>,
65 |     pub span: Span,
   |         ^^^^
   |
   = note: `AnnotatedTuple` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: field `span` is never read
  --> pixelflow-compiler/src/annotate.rs:72:9
   |
70 | pub struct AnnotatedLiteral {
   |            ---------------- field in this struct
71 |     pub lit: Lit,
72 |     pub span: Span,
   |         ^^^^
   |
   = note: `AnnotatedLiteral` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: field `span` is never read
  --> pixelflow-compiler/src/annotate.rs:83:9
   |
79 | pub struct AnnotatedBinary {
   |            --------------- field in this struct
...
83 |     pub span: Span,
   |         ^^^^
   |
   = note: `AnnotatedBinary` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: field `span` is never read
  --> pixelflow-compiler/src/annotate.rs:90:9
   |
87 | pub struct AnnotatedUnary {
   |            -------------- field in this struct
...
90 |     pub span: Span,
   |         ^^^^
   |
   = note: `AnnotatedUnary` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: field `span` is never read
  --> pixelflow-compiler/src/annotate.rs:98:9
   |
94 | pub struct AnnotatedMethodCall {
   |            ------------------- field in this struct
...
98 |     pub span: Span,
   |         ^^^^
   |
   = note: `AnnotatedMethodCall` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: field `span` is never read
   --> pixelflow-compiler/src/annotate.rs:106:9
    |
103 | pub struct AnnotatedCall {
    |            ------------- field in this struct
...
106 |     pub span: Span,
    |         ^^^^
    |
    = note: `AnnotatedCall` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: field `span` is never read
   --> pixelflow-compiler/src/annotate.rs:113:9
    |
110 | pub struct AnnotatedBlock {
    |            -------------- field in this struct
...
113 |     pub span: Span,
    |         ^^^^
    |
    = note: `AnnotatedBlock` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: field `span` is never read
   --> pixelflow-compiler/src/annotate.rs:127:9
    |
123 | pub struct AnnotatedLet {
    |            ------------ field in this struct
...
127 |     pub span: Span,
    |         ^^^^
    |
    = note: `AnnotatedLet` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: struct `AnnotationResult` is never constructed
   --> pixelflow-compiler/src/annotate.rs:138:12
    |
138 | pub struct AnnotationResult {
    |            ^^^^^^^^^^^^^^^^

warning: field `span` is never read
   --> pixelflow-compiler/src/ast.rs:128:9
    |
126 | pub struct IdentExpr {
    |            --------- field in this struct
127 |     pub name: Ident,
128 |     pub span: Span,
    |         ^^^^
    |
    = note: `IdentExpr` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: enum `BindingStrategy` is never used
  --> pixelflow-compiler/src/codegen/binding.rs:21:10
   |
21 | pub enum BindingStrategy {
   |          ^^^^^^^^^^^^^^^

warning: method `emit` is never used
  --> pixelflow-compiler/src/codegen/binding.rs:56:12
   |
52 | impl BindingStrategy {
   | -------------------- method in this implementation
...
56 |     pub fn emit(self, expr: TokenStream) -> TokenStream {
   |            ^^^^

warning: enum `Deps` is never used
  --> pixelflow-compiler/src/codegen/leveled.rs:56:10
   |
56 | pub enum Deps {
   |          ^^^^

warning: methods `join` and `is_uniform` are never used
  --> pixelflow-compiler/src/codegen/leveled.rs:68:12
   |
65 | impl Deps {
   | --------- methods in this implementation
...
68 |     pub fn join(self, other: Self) -> Self {
   |            ^^^^
...
74 |     pub fn is_uniform(&self) -> bool {
   |            ^^^^^^^^^^

warning: struct `LeveledNode` is never constructed
  --> pixelflow-compiler/src/codegen/leveled.rs:81:12
   |
81 | pub struct LeveledNode {
   |            ^^^^^^^^^^^

warning: enum `LeveledNodeKind` is never used
  --> pixelflow-compiler/src/codegen/leveled.rs:88:10
   |
88 | pub enum LeveledNodeKind {
   |          ^^^^^^^^^^^^^^^

warning: struct `NodeRef` is never constructed
   --> pixelflow-compiler/src/codegen/leveled.rs:107:12
    |
107 | pub struct NodeRef {
    |            ^^^^^^^

warning: associated items `new` and `var_name` are never used
   --> pixelflow-compiler/src/codegen/leveled.rs:113:12
    |
112 | impl NodeRef {
    | ------------ associated items in this implementation
113 |     pub fn new(level: usize, index: usize) -> Self {
    |            ^^^
...
118 |     pub fn var_name(&self) -> syn::Ident {
    |            ^^^^^^^^

warning: struct `LeveledExpr` is never constructed
   --> pixelflow-compiler/src/codegen/leveled.rs:124:12
    |
124 | pub struct LeveledExpr {
    |            ^^^^^^^^^^^

warning: struct `LevelBuilder` is never constructed
   --> pixelflow-compiler/src/codegen/leveled.rs:132:8
    |
132 | struct LevelBuilder<'a> {
    |        ^^^^^^^^^^^^

warning: associated items `new`, `build`, `compute_depths`, `compute_depth_recursive`, `assign_to_levels`, and `get_deps` are never used
   --> pixelflow-compiler/src/codegen/leveled.rs:141:8
    |
140 | impl<'a> LevelBuilder<'a> {
    | ------------------------- associated items in this implementation
141 |     fn new(analyzed: &'a AnalyzedKernel) -> Self {
    |        ^^^
...
151 |     fn build(&mut self, expr: &AnnotatedExpr) -> NodeRef {
    |        ^^^^^
...
164 |     fn compute_depths(&self, expr: &AnnotatedExpr) -> HashMap<usize, usize> {
    |        ^^^^^^^^^^^^^^
...
170 |     fn compute_depth_recursive(&self, expr: &AnnotatedExpr, depths: &mut HashMap<usize, usize>) -> usize {
    |        ^^^^^^^^^^^^^^^^^^^^^^^
...
241 |     fn assign_to_levels(&mut self, expr: &AnnotatedExpr, depths: &HashMap<usize, usize>) -> NodeRef {
    |        ^^^^^^^^^^^^^^^^
...
366 |     fn get_deps(&self, node_ref: NodeRef) -> Deps {
    |        ^^^^^^^^

warning: struct `DepsStats` is never constructed
   --> pixelflow-compiler/src/codegen/leveled.rs:373:12
    |
373 | pub struct DepsStats {
    |            ^^^^^^^^^

warning: method `hoisting_potential` is never used
   --> pixelflow-compiler/src/codegen/leveled.rs:383:12
    |
381 | impl DepsStats {
    | -------------- method in this implementation
382 |     /// Percentage of nodes that could potentially be hoisted
383 |     pub fn hoisting_potential(&self) -> f64 {
    |            ^^^^^^^^^^^^^^^^^^

warning: function `analyze_deps` is never used
   --> pixelflow-compiler/src/codegen/leveled.rs:394:8
    |
394 | pub fn analyze_deps(
    |        ^^^^^^^^^^^^

warning: function `emit_leveled` is never used
   --> pixelflow-compiler/src/codegen/leveled.rs:453:8
    |
453 | pub fn emit_leveled(
    |        ^^^^^^^^^^^^

warning: function `emit_node` is never used
   --> pixelflow-compiler/src/codegen/leveled.rs:484:4
    |
484 | fn emit_node(node: &LeveledNode, use_jet_wrapper: bool) -> TokenStream {
    |    ^^^^^^^^^

warning: function `build_tuple` is never used
  --> pixelflow-compiler/src/codegen/util.rs:36:8
   |
36 | pub fn build_tuple(values: &[TokenStream]) -> TokenStream {
   |        ^^^^^^^^^^^

warning: trait `ExprFold` is never used
  --> pixelflow-compiler/src/fold.rs:38:11
   |
38 | pub trait ExprFold {
   |           ^^^^^^^^

warning: function `fold_expr` is never used
   --> pixelflow-compiler/src/fold.rs:100:8
    |
100 | pub fn fold_expr<F: ExprFold>(folder: &mut F, expr: &Expr) -> F::Output {
    |        ^^^^^^^^^

warning: function `egraph_to_ir` is never used
   --> pixelflow-compiler/src/ir_bridge.rs:260:8
    |
260 | pub fn egraph_to_ir(tree: &ExprTree) -> IR {
    |        ^^^^^^^^^^^^

warning: function `ir_to_code` is never used
   --> pixelflow-compiler/src/ir_bridge.rs:400:8
    |
400 | pub fn ir_to_code(ir: &IR) -> TokenStream {
    |        ^^^^^^^^^^

warning: enum `TokenClass` is never used
  --> pixelflow-compiler/src/lexer.rs:30:10
   |
30 | pub enum TokenClass {
   |          ^^^^^^^^^^

warning: function `classify_ident` is never used
  --> pixelflow-compiler/src/lexer.rs:46:8
   |
46 | pub fn classify_ident(name: &str) -> TokenClass {
   |        ^^^^^^^^^^^^^^

warning: function `lex` is never used
  --> pixelflow-compiler/src/lexer.rs:56:8
   |
56 | pub fn lex(input: TokenStream) -> TokenStream {
   |        ^^^

warning: function `heuristic_score_rewrite` is never used
   --> pixelflow-compiler/src/optimize.rs:104:4
    |
104 | fn heuristic_score_rewrite(egraph: &EGraph, target: &pixelflow_search::egraph::RewriteTarget) -> i64 {
    |    ^^^^^^^^^^^^^^^^^^^^^^^

warning: struct `KernelParser` is never constructed
  --> pixelflow-compiler/src/parser.rs:43:8
   |
43 | struct KernelParser;
   |        ^^^^^^^^^^^^

warning: fields `name`, `ty`, and `span` are never read
  --> pixelflow-compiler/src/symbol.rs:57:9
   |
55 | pub struct Symbol {
   |            ------ fields in this struct
56 |     /// The identifier name.
57 |     pub name: Ident,
   |         ^^^^
...
61 |     pub ty: Option<Type>,
   |         ^^
62 |     /// Where the symbol was defined.
63 |     pub span: Span,
   |         ^^^^
   |
   = note: `Symbol` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: methods `is_parameter`, `parameters`, `is_manifold_param`, and `manifold_params` are never used
   --> pixelflow-compiler/src/symbol.rs:166:12
    |
 75 | impl SymbolTable {
    | ---------------- methods in this implementation
...
166 |     pub fn is_parameter(&self, name: &str) -> bool {
    |            ^^^^^^^^^^^^
...
173 |     pub fn parameters(&self) -> impl Iterator<Item = &Symbol> {
    |            ^^^^^^^^^^
...
180 |     pub fn is_manifold_param(&self, name: &str) -> bool {
    |            ^^^^^^^^^^^^^^^^^
...
187 |     pub fn manifold_params(&self) -> impl Iterator<Item = &Symbol> {
    |            ^^^^^^^^^^^^^^^

warning: `pixelflow-compiler` (lib) generated 55 warnings (run `cargo fix --lib -p pixelflow-compiler` to apply 16 suggestions)
warning: `pixelflow-search` (lib) generated 22 warnings (22 duplicates)
warning: unused import: `crate::numeric::Numeric`
 --> pixelflow-core/src/ops/logic.rs:6:5
  |
6 | use crate::numeric::Numeric;
  |     ^^^^^^^^^^^^^^^^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: unused imports: `BitAnd`, `BitOr`, and `Not`
 --> pixelflow-core/src/ops/logic.rs:7:17
  |
7 | use core::ops::{BitAnd, BitOr, Not};
  |                 ^^^^^^  ^^^^^  ^^^

warning: unused import: `Computational`
 --> pixelflow-core/src/ops/unary.rs:2:22
  |
2 | use crate::numeric::{Computational, Numeric};
  |                      ^^^^^^^^^^^^^

warning: unused macro definition: `impl_spatial_for_context`
   --> pixelflow-core/src/combinators/context.rs:495:14
    |
495 | macro_rules! impl_spatial_for_context {
    |              ^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: `#[warn(unused_macros)]` (part of `#[warn(unused)]`) on by default

warning: ambiguous glob re-exports
   --> pixelflow-core/src/lib.rs:193:9
    |
193 | pub use manifold::*;
    |         ^^^^^^^^^^^ the name `Scale` in the type namespace is first re-exported here
194 | pub use numeric::{Computational, Coordinate, Selectable};
195 | pub use ops::binary::*;
    |         -------------- but the name `Scale` in the type namespace is also re-exported here
    |
    = note: `#[warn(ambiguous_glob_reexports)]` on by default

warning: unused import: `crate::numeric::Numeric`
   --> pixelflow-core/src/jet/jet2.rs:558:13
    |
558 |         use crate::numeric::Numeric as _;
    |             ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::numeric::Numeric`
   --> pixelflow-core/src/jet/jet2.rs:675:13
    |
675 |         use crate::numeric::Numeric as _;
    |             ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::numeric::Numeric`
   --> pixelflow-core/src/jet/jet2.rs:689:13
    |
689 |         use crate::numeric::Numeric as _;
    |             ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::numeric::Numeric`
   --> pixelflow-core/src/jet/jet2.rs:703:13
    |
703 |         use crate::numeric::Numeric as _;
    |             ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::numeric::Numeric`
   --> pixelflow-core/src/jet/jet2.rs:748:13
    |
748 |         use crate::numeric::Numeric as _;
    |             ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::numeric::Numeric`
   --> pixelflow-core/src/jet/jet2h.rs:973:13
    |
973 |         use crate::numeric::Numeric as _;
    |             ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::numeric::Numeric`
   --> pixelflow-core/src/jet/jet2h.rs:989:13
    |
989 |         use crate::numeric::Numeric as _;
    |             ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::numeric::Numeric`
    --> pixelflow-core/src/jet/jet2h.rs:1006:13
     |
1006 |         use crate::numeric::Numeric as _;
     |             ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::numeric::Numeric`
   --> pixelflow-core/src/jet/jet3.rs:651:13
    |
651 |         use crate::numeric::Numeric as _;
    |             ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::numeric::Numeric`
   --> pixelflow-core/src/jet/jet3.rs:860:13
    |
860 |         use crate::numeric::Numeric as _;
    |             ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::numeric::Numeric`
  --> pixelflow-core/src/combinators/select.rs:23:5
   |
23 | use crate::numeric::Numeric;
   |     ^^^^^^^^^^^^^^^^^^^^^^^

warning: associated items `from_slice` and `mul_rsqrt` are never used
   --> pixelflow-core/src/lib.rs:688:8
    |
422 | impl Field {
    | ---------- associated items in this implementation
...
688 |     fn from_slice(slice: &[f32]) -> Self {
    |        ^^^^^^^^^^
...
758 |     pub(crate) fn mul_rsqrt(self, other: Self) -> Self {
    |                   ^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: method `map_partials` is never used
   --> pixelflow-core/src/dual.rs:110:8
    |
 71 | impl<const N: usize, A: Algebra> Dual<N, A> {
    | ------------------------------------------- method in this implementation
...
110 |     fn map_partials<F>(self, f: F) -> Self
    |        ^^^^^^^^^^^^

warning: multiple associated items are never used
   --> pixelflow-core/src/numeric.rs:79:8
    |
 65 | pub(crate) trait Numeric: Computational {
    |                  ------- associated items in this trait
...
 79 |     fn lt(self, rhs: Self) -> Self;
    |        ^^
...
 82 |     fn le(self, rhs: Self) -> Self;
    |        ^^
...
 85 |     fn gt(self, rhs: Self) -> Self;
    |        ^^
...
 88 |     fn ge(self, rhs: Self) -> Self;
    |        ^^
...
 93 |     fn select(mask: Self, if_true: Self, if_false: Self) -> Self;
    |        ^^^^^^
...
 97 |     fn select_raw(mask: Self, if_true: Self, if_false: Self) -> Self;
    |        ^^^^^^^^^^
...
102 |     fn any(&self) -> bool;
    |        ^^^
...
107 |     fn all(&self) -> bool;
    |        ^^^
...
110 |     fn from_i32(val: i32) -> Self;
    |        ^^^^^^^^
...
113 |     fn from_field(field: crate::Field) -> Self;
    |        ^^^^^^^^^^
...
174 |     fn mul_rsqrt(self, other: Self) -> Self;
    |        ^^^^^^^^^
...
180 |     fn eq(self, rhs: Self) -> Self;
    |        ^^
...
183 |     fn ne(self, rhs: Self) -> Self;
    |        ^^

warning: type alias `Field4` is never used
   --> pixelflow-core/src/ops/derivative.rs:509:6
    |
509 | type Field4 = (Field, Field, Field, Field);
    |      ^^^^^^

warning: type alias `Jet2_4` is never used
   --> pixelflow-core/src/ops/derivative.rs:510:6
    |
510 | type Jet2_4 = (Jet2, Jet2, Jet2, Jet2);
    |      ^^^^^^

warning: type alias `Jet3_4` is never used
   --> pixelflow-core/src/ops/derivative.rs:511:6
    |
511 | type Jet3_4 = (Jet3, Jet3, Jet3, Jet3);
    |      ^^^^^^

warning: missing documentation for a type alias
   --> pixelflow-core/src/storage.rs:114:1
    |
114 | pub type NativeMaskStorage = crate::backend::arm::Mask4;
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
note: the lint level is defined here
   --> pixelflow-core/src/lib.rs:130:9
    |
130 | #![warn(missing_docs)]
    |         ^^^^^^^^^^^^

warning: missing documentation for a module
 --> pixelflow-core/src/ops/mod.rs:2:1
  |
2 | pub mod compare;
  | ^^^^^^^^^^^^^^^

warning: missing documentation for a module
 --> pixelflow-core/src/ops/mod.rs:6:1
  |
6 | pub mod unary;
  | ^^^^^^^^^^^^^

warning: missing documentation for a trait
   --> pixelflow-core/src/combinators/binding.rs:164:1
    |
164 | pub trait Pred {
    | ^^^^^^^^^^^^^^

warning: missing documentation for an associated type
   --> pixelflow-core/src/combinators/binding.rs:165:5
    |
165 |     type Output;
    |     ^^^^^^^^^^^

warning: missing documentation for a struct field
  --> pixelflow-core/src/combinators/fix.rs:21:5
   |
21 |     pub seed: Seed,
   |     ^^^^^^^^^^^^^^

warning: missing documentation for a struct field
  --> pixelflow-core/src/combinators/fix.rs:22:5
   |
22 |     pub step: Step,
   |     ^^^^^^^^^^^^^^

warning: missing documentation for a struct field
  --> pixelflow-core/src/combinators/fix.rs:23:5
   |
23 |     pub done: Done,
   |     ^^^^^^^^^^^^^^

warning: missing documentation for a struct field
  --> pixelflow-core/src/combinators/fix.rs:69:5
   |
69 |     pub coords: P,
   |     ^^^^^^^^^^^^^

   Compiling pixelflow-pipeline v0.1.0 (/Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline)
warning: unexpected `cfg` condition value: `std`
  --> pixelflow-pipeline/src/training/data_gen.rs:97:7
   |
97 | #[cfg(feature = "std")]
   |       ^^^^^^^^^^^^^^^
   |
   = note: expected values for `feature` are: `default` and `training`
   = help: consider adding `std` as a feature in `Cargo.toml`
   = note: see <https://doc.rust-lang.org/nightly/rustc/check-cfg/cargo-specifics.html> for more information about checking conditional configuration
   = note: `#[warn(unexpected_cfgs)]` on by default

warning: unexpected `cfg` condition value: `std`
   --> pixelflow-pipeline/src/training/data_gen.rs:385:7
    |
385 | #[cfg(feature = "std")]
    |       ^^^^^^^^^^^^^^^
    |
    = note: expected values for `feature` are: `default` and `training`
    = help: consider adding `std` as a feature in `Cargo.toml`
    = note: see <https://doc.rust-lang.org/nightly/rustc/check-cfg/cargo-specifics.html> for more information about checking conditional configuration

warning: unexpected `cfg` condition value: `std`
   --> pixelflow-pipeline/src/training/data_gen.rs:420:7
    |
420 | #[cfg(feature = "std")]
    |       ^^^^^^^^^^^^^^^
    |
    = note: expected values for `feature` are: `default` and `training`
    = help: consider adding `std` as a feature in `Cargo.toml`
    = note: see <https://doc.rust-lang.org/nightly/rustc/check-cfg/cargo-specifics.html> for more information about checking conditional configuration

warning: unused import: `RewriteRule`
  --> pixelflow-pipeline/src/training/data_gen.rs:46:64
   |
46 |     Expr, ExprGenConfig, ExprGenerator, HalfEPFeature, OpType, RewriteRule,
   |                                                                ^^^^^^^^^^^
   |
   = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: unused imports: `BestFirstConfig`, `BestFirstContext`, `BestFirstPlanner`, and `CostModel`
  --> pixelflow-pipeline/src/training/egraph.rs:16:5
   |
16 |     BestFirstPlanner, BestFirstConfig, BestFirstContext, CostModel,
   |     ^^^^^^^^^^^^^^^^  ^^^^^^^^^^^^^^^  ^^^^^^^^^^^^^^^^  ^^^^^^^^^

warning: unused import: `OpKind`
  --> pixelflow-pipeline/src/training/egraph.rs:19:38
   |
19 |     Nnue, NnueConfig, HalfEPFeature, OpKind, DenseFeatures,
   |                                      ^^^^^^

warning: unused imports: `extract_tree_features` and `op_counts_to_dense`
  --> pixelflow-pipeline/src/training/egraph.rs:22:23
   |
22 | use super::features::{extract_tree_features, op_counts_to_dense};
   |                       ^^^^^^^^^^^^^^^^^^^^^  ^^^^^^^^^^^^^^^^^^

warning: unused imports: `ForwardState` and `HybridForwardState`
  --> pixelflow-pipeline/src/training/egraph.rs:23:97
   |
23 | use super::backprop::{forward_with_state, forward_with_state_hybrid, backward, backward_hybrid, ForwardState, HybridForwardState};
   |                                                                                                 ^^^^^^^^^^^^  ^^^^^^^^^^^^^^^^^^

warning: `pixelflow-core` (lib) generated 31 warnings (run `cargo fix --lib -p pixelflow-core` to apply 3 suggestions)
warning: variable does not need to be mutable
   --> pixelflow-pipeline/src/training/egraph.rs:284:9
    |
284 |     let mut test_indices: Vec<usize> = test_families.iter()
    |         ----^^^^^^^^^^^^
    |         |
    |         help: remove this `mut`
    |
    = note: `#[warn(unused_mut)]` (part of `#[warn(unused)]`) on by default

warning: hiding a lifetime that's elided elsewhere is confusing
   --> pixelflow-pipeline/src/training/factored.rs:862:19
    |
862 | fn kc_expr(input: &str) -> ParseResult<Expr> {
    |                   ^^^^     ^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                   |
    |                   the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
    = note: `#[warn(mismatched_lifetime_syntaxes)]` on by default
help: use `'_` for type paths
    |
862 | fn kc_expr(input: &str) -> ParseResult<'_, Expr> {
    |                                        +++

warning: hiding a lifetime that's elided elsewhere is confusing
   --> pixelflow-pipeline/src/training/factored.rs:867:26
    |
867 | fn parse_additive(input: &str) -> ParseResult<Expr> {
    |                          ^^^^     ^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                          |
    |                          the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
    |
867 | fn parse_additive(input: &str) -> ParseResult<'_, Expr> {
    |                                               +++

warning: hiding a lifetime that's elided elsewhere is confusing
   --> pixelflow-pipeline/src/training/factored.rs:879:29
    |
879 | fn parse_additive_op(input: &str) -> ParseResult<OpKind> {
    |                             ^^^^     ^^^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                             |
    |                             the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
    |
879 | fn parse_additive_op(input: &str) -> ParseResult<'_, OpKind> {
    |                                                  +++

warning: hiding a lifetime that's elided elsewhere is confusing
   --> pixelflow-pipeline/src/training/factored.rs:888:32
    |
888 | fn parse_multiplicative(input: &str) -> ParseResult<Expr> {
    |                                ^^^^     ^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                                |
    |                                the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
    |
888 | fn parse_multiplicative(input: &str) -> ParseResult<'_, Expr> {
    |                                                     +++

warning: hiding a lifetime that's elided elsewhere is confusing
   --> pixelflow-pipeline/src/training/factored.rs:900:35
    |
900 | fn parse_multiplicative_op(input: &str) -> ParseResult<OpKind> {
    |                                   ^^^^     ^^^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                                   |
    |                                   the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
    |
900 | fn parse_multiplicative_op(input: &str) -> ParseResult<'_, OpKind> {
    |                                                        +++

warning: hiding a lifetime that's elided elsewhere is confusing
   --> pixelflow-pipeline/src/training/factored.rs:909:25
    |
909 | fn parse_postfix(input: &str) -> ParseResult<Expr> {
    |                         ^^^^     ^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                         |
    |                         the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
    |
909 | fn parse_postfix(input: &str) -> ParseResult<'_, Expr> {
    |                                              +++

warning: hiding a lifetime that's elided elsewhere is confusing
   --> pixelflow-pipeline/src/training/factored.rs:983:25
    |
983 | fn parse_primary(input: &str) -> ParseResult<Expr> {
    |                         ^^^^     ^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                         |
    |                         the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
    |
983 | fn parse_primary(input: &str) -> ParseResult<'_, Expr> {
    |                                              +++

warning: hiding a lifetime that's elided elsewhere is confusing
    --> pixelflow-pipeline/src/training/factored.rs:1004:26
     |
1004 | fn parse_variable(input: &str) -> ParseResult<Expr> {
     |                          ^^^^     ^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
     |                          |
     |                          the lifetime is elided here
     |
     = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
     |
1004 | fn parse_variable(input: &str) -> ParseResult<'_, Expr> {
     |                                               +++

warning: hiding a lifetime that's elided elsewhere is confusing
    --> pixelflow-pipeline/src/training/factored.rs:1016:24
     |
1016 | fn parse_number(input: &str) -> ParseResult<Expr> {
     |                        ^^^^     ^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
     |                        |
     |                        the lifetime is elided here
     |
     = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
     |
1016 | fn parse_number(input: &str) -> ParseResult<'_, Expr> {
     |                                             +++

warning: hiding a lifetime that's elided elsewhere is confusing
    --> pixelflow-pipeline/src/training/factored.rs:1033:23
     |
1033 | fn parse_ident(input: &str) -> ParseResult<&str> {
     |                       ^^^^     ^^^^^^^^^^^^^^^^^
     |                       |        |           |
     |                       |        |           the same lifetime is elided here
     |                       |        the same lifetime is hidden here
     |                       the lifetime is elided here
     |
     = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
     |
1033 | fn parse_ident(input: &str) -> ParseResult<'_, &str> {
     |                                            +++

warning: `pixelflow-pipeline` (lib) generated 19 warnings (run `cargo fix --lib -p pixelflow-pipeline` to apply 16 suggestions)
    Finished `release` profile [optimized] target(s) in 2.31s
     Running `target/release/collect_guide_data --count 500 --perturbations 3 --sigma 0.1 --threshold 0.0 --max-epochs 30 --seed 42`
Collecting actor-rollout replay buffer...
  Expressions: 500
  Perturbations: 3
  Sigma: 0.1
  Max epochs: 30
  Threshold: 0
  Seed: 42
  Guide weights: random init (no --guide-weights)
  Existing records: 0 (appending)
  Random seeds: 500, Targeted families: 18
  [5/518] 2905 nodes, 0.0s, 15 trajectories, 20 epoch records
  [10/518] 9 nodes, 0.0s, 30 trajectories, 43 epoch records
  [15/518] 2872 nodes, 0.6s, 45 trajectories, 68 epoch records
  [20/518] 1 nodes, 0.0s, 60 trajectories, 95 epoch records
  [25/518] 41686 nodes, 0.0s, 75 trajectories, 114 epoch records
  [30/518] 87 nodes, 0.0s, 90 trajectories, 159 epoch records
  [31/518] 1127 nodes, 58.4s, 93 trajectories, 173 epoch records
  [35/518] 997 nodes, 0.0s, 105 trajectories, 193 epoch records
  [40/518] 15 nodes, 0.0s, 120 trajectories, 215 epoch records
  [45/518] 1411 nodes, 0.0s, 135 trajectories, 239 epoch records
  [50/518] 373 nodes, 0.4s, 150 trajectories, 262 epoch records
  [55/518] 1 nodes, 0.0s, 165 trajectories, 285 epoch records
  [60/518] 2548 nodes, 0.5s, 180 trajectories, 304 epoch records
  [65/518] 2004 nodes, 0.0s, 195 trajectories, 331 epoch records
  [70/518] 4 nodes, 0.0s, 210 trajectories, 370 epoch records
  [75/518] 1 nodes, 0.0s, 225 trajectories, 407 epoch records
  [80/518] 14 nodes, 0.0s, 240 trajectories, 430 epoch records
  [82/518] 745 nodes, 3.4s, 246 trajectories, 448 epoch records
  [85/518] 34171 nodes, 0.0s, 255 trajectories, 459 epoch records
  [90/518] 317 nodes, 1.3s, 270 trajectories, 491 epoch records
  [95/518] 169176 nodes, 0.1s, 285 trajectories, 526 epoch records
  [100/518] 3 nodes, 0.0s, 300 trajectories, 557 epoch records
  [105/518] 10654 nodes, 0.1s, 315 trajectories, 576 epoch records
  [110/518] 1 nodes, 0.0s, 330 trajectories, 607 epoch records
  [115/518] 601 nodes, 12.0s, 345 trajectories, 640 epoch records
  [120/518] 14 nodes, 0.0s, 360 trajectories, 663 epoch records
  [125/518] 10316 nodes, 0.0s, 375 trajectories, 690 epoch records
  [129/518] 1269 nodes, 5.8s, 387 trajectories, 722 epoch records
  [130/518] 685 nodes, 1.3s, 390 trajectories, 734 epoch records
  [135/518] 6571 nodes, 0.0s, 405 trajectories, 752 epoch records
  [140/518] 412 nodes, 0.4s, 420 trajectories, 791 epoch records
  [144/518] 588 nodes, 4.3s, 432 trajectories, 834 epoch records
  [145/518] 19603 nodes, 0.0s, 435 trajectories, 834 epoch records
  [150/518] 75 nodes, 0.0s, 450 trajectories, 859 epoch records
  [151/518] 2998 nodes, 28.6s, 453 trajectories, 864 epoch records
  [155/518] 9072 nodes, 0.0s, 465 trajectories, 875 epoch records
  [160/518] 939 nodes, 0.4s, 480 trajectories, 898 epoch records
  [165/518] 1 nodes, 0.0s, 495 trajectories, 924 epoch records
  [170/518] 291 nodes, 6.5s, 510 trajectories, 972 epoch records
  [175/518] 3663 nodes, 0.8s, 525 trajectories, 1004 epoch records
  [180/518] 1 nodes, 0.0s, 540 trajectories, 1024 epoch records
  [185/518] 1087 nodes, 2.8s, 555 trajectories, 1058 epoch records
  [190/518] 4666 nodes, 0.0s, 570 trajectories, 1076 epoch records
  [195/518] 106 nodes, 0.0s, 585 trajectories, 1099 epoch records
  [196/518] 1133 nodes, 122.3s, 588 trajectories, 1117 epoch records
  [200/518] 3 nodes, 0.0s, 600 trajectories, 1139 epoch records
  [205/518] 245 nodes, 0.1s, 615 trajectories, 1180 epoch records
  [208/518] 666 nodes, 39.4s, 624 trajectories, 1209 epoch records
  [210/518] 2 nodes, 0.0s, 630 trajectories, 1212 epoch records
  [215/518] 2 nodes, 0.0s, 645 trajectories, 1231 epoch records
  [220/518] 1 nodes, 0.0s, 660 trajectories, 1248 epoch records
  [225/518] 931 nodes, 4.9s, 675 trajectories, 1278 epoch records
  [230/518] 1077 nodes, 0.1s, 690 trajectories, 1339 epoch records
  [235/518] 174 nodes, 0.1s, 705 trajectories, 1371 epoch records
  [239/518] 5974 nodes, 3.7s, 717 trajectories, 1393 epoch records
  [240/518] 9 nodes, 0.0s, 720 trajectories, 1398 epoch records
  [245/518] 47416 nodes, 0.0s, 735 trajectories, 1425 epoch records
  [250/518] 1169 nodes, 7.7s, 750 trajectories, 1452 epoch records
  [255/518] 30079 nodes, 0.0s, 765 trajectories, 1482 epoch records
  [260/518] 409 nodes, 0.0s, 780 trajectories, 1494 epoch records
  [265/518] 290 nodes, 0.0s, 795 trajectories, 1520 epoch records
  [270/518] 3149 nodes, 0.0s, 810 trajectories, 1540 epoch records
  [272/518] 595 nodes, 11.4s, 816 trajectories, 1570 epoch records
  [275/518] 1 nodes, 0.0s, 825 trajectories, 1578 epoch records
  [280/518] 6 nodes, 0.0s, 840 trajectories, 1615 epoch records
  [282/518] 563 nodes, 6.2s, 846 trajectories, 1629 epoch records
  [285/518] 22451 nodes, 0.0s, 855 trajectories, 1635 epoch records
  [288/518] 1277 nodes, 8.3s, 864 trajectories, 1655 epoch records
  [290/518] 1 nodes, 0.0s, 870 trajectories, 1685 epoch records
  [294/518] 428 nodes, 3.2s, 882 trajectories, 1707 epoch records
  [295/518] 2231 nodes, 0.0s, 885 trajectories, 1710 epoch records
  [300/518] 61 nodes, 0.0s, 900 trajectories, 1752 epoch records
  [302/518] 908 nodes, 20.1s, 906 trajectories, 1779 epoch records
  [305/518] 349 nodes, 0.5s, 915 trajectories, 1804 epoch records
  [306/518] 442 nodes, 3.7s, 918 trajectories, 1821 epoch records
  [310/518] 1 nodes, 0.0s, 930 trajectories, 1837 epoch records
  [315/518] 216 nodes, 1.3s, 945 trajectories, 1861 epoch records
  [320/518] 5 nodes, 0.0s, 960 trajectories, 1882 epoch records
  [325/518] 2 nodes, 0.0s, 975 trajectories, 1907 epoch records
  [330/518] 3 nodes, 0.0s, 990 trajectories, 1941 epoch records
  [335/518] 11 nodes, 0.0s, 1005 trajectories, 1962 epoch records
  [340/518] 166966 nodes, 0.1s, 1020 trajectories, 1982 epoch records
  [344/518] 509 nodes, 10.6s, 1032 trajectories, 2003 epoch records
  [345/518] 1 nodes, 0.0s, 1035 trajectories, 2006 epoch records
  [350/518] 444 nodes, 0.0s, 1050 trajectories, 2048 epoch records
  [355/518] 26 nodes, 0.0s, 1065 trajectories, 2065 epoch records
  [358/518] 542 nodes, 42.9s, 1074 trajectories, 2101 epoch records
  [360/518] 725 nodes, 0.0s, 1080 trajectories, 2107 epoch records
  [365/518] 1 nodes, 0.0s, 1095 trajectories, 2130 epoch records
  [366/518] 575 nodes, 10.5s, 1098 trajectories, 2148 epoch records
  [370/518] 3 nodes, 0.0s, 1110 trajectories, 2164 epoch records
  [375/518] 172 nodes, 0.0s, 1125 trajectories, 2200 epoch records
  [380/518] 5 nodes, 0.0s, 1140 trajectories, 2218 epoch records
  [385/518] 42113 nodes, 0.0s, 1155 trajectories, 2231 epoch records
  [390/518] 12879 nodes, 0.0s, 1170 trajectories, 2251 epoch records
  [392/518] 1292 nodes, 4.3s, 1176 trajectories, 2272 epoch records
  [395/518] 1078 nodes, 2.0s, 1185 trajectories, 2293 epoch records
  [400/518] 72 nodes, 0.0s, 1200 trajectories, 2316 epoch records
  [404/518] 2242 nodes, 5.7s, 1212 trajectories, 2332 epoch records
  [405/518] 50835 nodes, 0.0s, 1215 trajectories, 2332 epoch records
  [410/518] 4679 nodes, 0.0s, 1230 trajectories, 2361 epoch records
  [415/518] 584 nodes, 0.6s, 1245 trajectories, 2388 epoch records
  [420/518] 1 nodes, 0.0s, 1260 trajectories, 2406 epoch records
  [425/518] 53 nodes, 0.0s, 1275 trajectories, 2436 epoch records
  [430/518] 1763 nodes, 0.0s, 1290 trajectories, 2462 epoch records
  [431/518] 2067 nodes, 4.8s, 1293 trajectories, 2468 epoch records
  [435/518] 3 nodes, 0.0s, 1305 trajectories, 2485 epoch records
  [440/518] 63 nodes, 0.0s, 1320 trajectories, 2507 epoch records
  [445/518] 4 nodes, 0.0s, 1335 trajectories, 2526 epoch records
  [450/518] 25 nodes, 0.0s, 1350 trajectories, 2547 epoch records
  [455/518] 1 nodes, 0.0s, 1365 trajectories, 2567 epoch records
  [458/518] 1938 nodes, 10.4s, 1374 trajectories, 2598 epoch records
  [460/518] 269 nodes, 0.1s, 1380 trajectories, 2618 epoch records
  [465/518] 4 nodes, 0.0s, 1395 trajectories, 2644 epoch records
  [470/518] 216 nodes, 0.5s, 1410 trajectories, 2714 epoch records
  [475/518] 1 nodes, 0.0s, 1425 trajectories, 2732 epoch records
  [480/518] 62245 nodes, 0.0s, 1440 trajectories, 2748 epoch records
  [485/518] 98 nodes, 0.0s, 1455 trajectories, 2772 epoch records
  [488/518] 505 nodes, 13.2s, 1464 trajectories, 2793 epoch records
  [490/518] 1 nodes, 0.0s, 1470 trajectories, 2799 epoch records
  [494/518] 310 nodes, 6.7s, 1482 trajectories, 2844 epoch records
  [495/518] 244 nodes, 0.1s, 1485 trajectories, 2857 epoch records
  [500/518] 9 nodes, 0.0s, 1500 trajectories, 2876 epoch records
  [505/518] 3 nodes, 0.0s, 1515 trajectories, 2899 epoch records
  [510/518] 10 nodes, 0.0s, 1530 trajectories, 2921 epoch records
  [515/518] 5 nodes, 0.0s, 1545 trajectories, 2957 epoch records

Collection complete!
  Total trajectories: 1554
  Total epoch records: 3024
  Avg epochs/trajectory: 1.9
  Output: /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/guide_training.jsonl

Collection complete:     3024 records in 537s

================================================================
  Stage 2: Training actor-critic OPD
  Sun Feb 22 22:57:28 EST 2026
================================================================
Device: mps
Loading replay buffer...
  Loaded 1000 epoch records (40000 samples)...
  Loaded 2000 epoch records (80000 samples)...
  Loaded 3000 epoch records (120000 samples)...
Loaded 120960 policy samples from 3024 epochs (3024 unique graphs) in /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/guide_training.jsonl
Samples: 120960, Graphs: 3024, Rules: 40
Train: 96768, Val: 24192
Critic: 274,432 params, PolicyHead: 14,976 params, Actor: 353 params

Epoch    Critic MSE     Actor BCE
---------------------------------
    1      0.088394      6.590575  val_actor=0.747454  (18.0s) *
    2      0.066053      0.641127  val_actor=0.522132  (14.6s) *
    3      0.059585      0.508515  val_actor=0.452125  (14.5s) *
    4      0.055908      0.462961  val_actor=0.445628  (14.9s) *
    5      0.052472      0.451560  val_actor=0.421489  (15.6s) *
    6      0.049461      0.437781  val_actor=0.432608  (14.6s)
    7      0.046984      0.431429  val_actor=0.410216  (14.5s) *
    8      0.045497      0.430188  val_actor=0.389359  (14.5s) *
    9      0.044233      0.418087  val_actor=0.399351  (14.6s)
   10      0.043365      0.413526  val_actor=0.433197  (14.6s)
   11      0.042459      0.411189  val_actor=0.408369  (14.5s)
   12      0.041732      0.404645  val_actor=0.382919  (15.9s) *
   13      0.041613      0.412074  val_actor=0.568127  (15.2s)
   14      0.040912      0.400417  val_actor=0.390075  (18.0s)
   15      0.040452      0.398741  val_actor=0.379976  (20.4s) *
   16      0.040336      0.399067  val_actor=0.400622  (21.9s)
   17      0.039688      0.397167  val_actor=0.367853  (22.2s) *
   18      0.039330      0.391343  val_actor=0.370287  (23.4s)
   19      0.039421      0.390186  val_actor=0.355313  (21.1s) *
   20      0.038915      0.391388  val_actor=0.368558  (19.4s)
   21      0.039008      0.400126  val_actor=0.382228  (18.7s)
   22      0.038391      0.385427  val_actor=0.373072  (18.4s)
   23      0.038502      0.384393  val_actor=0.365929  (17.2s)
   24      0.038344      0.391919  val_actor=0.366180  (16.1s)
   25      0.038163      0.382187  val_actor=0.372254  (15.1s)
   26      0.038262      0.386600  val_actor=0.377065  (14.8s)
   27      0.037500      0.388762  val_actor=0.404117  (14.7s)
   28      0.037709      0.383714  val_actor=0.356480  (14.6s)
   29      0.037428      0.385638  val_actor=0.391710  (14.8s)
   30      0.037134      0.382281  val_actor=0.345893  (15.1s) *
   31      0.036844      0.386430  val_actor=0.344506  (14.4s) *
   32      0.036856      0.373313  val_actor=0.345940  (14.5s)
   33      0.036908      0.383185  val_actor=0.361350  (15.7s)
   34      0.036673      0.379113  val_actor=0.353725  (14.5s)
   35      0.036252      0.382443  val_actor=0.373274  (14.5s)
   36      0.036559      0.375910  val_actor=0.355716  (14.5s)
   37      0.036280      0.380218  val_actor=0.426858  (15.9s)
   38      0.036320      0.373668  val_actor=0.346461  (14.6s)
   39      0.035754      0.376342  val_actor=0.361442  (15.2s)
   40      0.036380      0.376644  val_actor=0.345074  (16.9s)
   41      0.036180      0.376261  val_actor=0.339472  (14.4s) *
   42      0.036072      0.371402  val_actor=0.340305  (14.5s)
   43      0.036036      0.375921  val_actor=0.403928  (15.8s)
   44      0.035819      0.373752  val_actor=0.344163  (14.7s)
   45      0.035646      0.382646  val_actor=0.345438  (14.7s)
   46      0.035824      0.375081  val_actor=0.337494  (15.0s) *
   47      0.035865      0.374375  val_actor=0.375094  (15.8s)
   48      0.035473      0.367511  val_actor=0.356333  (14.5s)
   49      0.035787      0.375338  val_actor=0.339474  (14.5s)
   50      0.035409      0.376995  val_actor=0.348094  (14.4s)
   51      0.035631      0.378464  val_actor=0.369142  (15.7s)
   52      0.035398      0.379425  val_actor=0.346974  (14.5s)
   53      0.035360      0.379881  val_actor=0.348345  (14.4s)
   54      0.035660      0.373043  val_actor=0.338246  (14.8s)
   55      0.035547      0.371684  val_actor=0.347402  (16.3s)
   56      0.035210      0.370998  val_actor=0.341205  (14.5s)
   57      0.035134      0.369144  val_actor=0.349809  (15.0s)
   58      0.035308      0.386977  val_actor=0.352341  (14.4s)
   59      0.035146      0.369546  val_actor=0.373219  (14.9s)
   60      0.035331      0.373179  val_actor=0.361603  (14.9s)
   61      0.035203      0.370376  val_actor=0.345447  (15.5s)
   62      0.034952      0.377442  val_actor=0.343518  (15.1s)
   63      0.035037      0.376685  val_actor=0.363574  (14.4s)
   64      0.035048      0.370468  val_actor=0.350570  (14.4s)
   65      0.035047      0.374297  val_actor=0.349557  (14.4s)
   66      0.034883      0.376776  val_actor=0.377048  (14.4s)
   67      0.035006      0.369034  val_actor=0.395621  (14.3s)
   68      0.034911      0.372862  val_actor=0.365000  (14.4s)
   69      0.034811      0.369209  val_actor=0.357675  (15.1s)
   70      0.035050      0.376997  val_actor=0.418044  (14.5s)
   71      0.034694      0.366845  val_actor=0.336476  (14.5s) *
   72      0.034730      0.377132  val_actor=0.361333  (14.4s)
   73      0.034604      0.369305  val_actor=0.348963  (14.8s)
   74      0.034731      0.371089  val_actor=0.339466  (14.5s)
   75      0.034719      0.379275  val_actor=0.427604  (14.5s)
   76      0.034502      0.369304  val_actor=0.365122  (14.4s)
   77      0.034453      0.382906  val_actor=0.341560  (14.7s)
   78      0.034819      0.369077  val_actor=0.337983  (14.6s)
   79      0.034426      0.373499  val_actor=0.360316  (14.5s)
   80      0.034590      0.374756  val_actor=0.371014  (14.5s)

Best val actor loss: 0.336476 at epoch 71
Teacher checkpoint: /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/graph_teacher_v2.pt
Student binary: /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/guide_v2.bin

Training complete in 1624s

================================================================
  Stage 3: Verify exported weights
  Sun Feb 22 23:24:32 EST 2026
================================================================
Guide weights OK: /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/guide_v2.bin (    1412 bytes, 1412 expected)

================================================================
  Pipeline Complete
  Finished: Sun Feb 22 23:24:32 EST 2026
  Total time: 2161s
================================================================

Artifacts:
  Replay buffer:  /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/guide_training.jsonl (    3024 records)
  Teacher ckpt:   /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/graph_teacher_v2.pt
  Guide weights:  /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/guide_v2.bin
  Log:            /Users/jppittman/Documents/Projects/core-term/pixelflow-pipeline/data/logs/train_overnight_20260222_224828.log
