[package]
name = "pixelflow-ml"
version = "0.1.0"
edition = "2024"
description = "Neural networks for graphics and compiler optimization"

[lints]
workspace = true

[lib]
bench = false

[features]
default = ["graphics"]
# Enable std for benchmarking and training data generation
std = ["pixelflow-nnue/std"]
# Enable training data generation (requires std + graphics for real SIMD benchmarks)
training = ["std", "graphics"]
# Enable graphics integration (harmonic attention, SH features) - requires pixelflow-core
graphics = ["dep:pixelflow-core"]
# Disable kernel! macro optimization - for benchmarking unoptimized expressions
no_optimize = ["pixelflow-core/no_optimize"]

[dependencies]
pixelflow-core = { path = "../pixelflow-core", optional = true }
pixelflow-nnue = { path = "../pixelflow-nnue", default-features = false }
libm = "0.2.15"

[target.'cfg(target_os = "linux")'.dependencies]
libc = "0.2"

[dev-dependencies]
criterion = "0.5"
pixelflow-core = { path = "../pixelflow-core" }
pixelflow-macros = { path = "../pixelflow-macros" }
pixelflow-search = { path = "../pixelflow-search", features = ["std"] }

[[bench]]
name = "hce_bench"
harness = false

[[bench]]
name = "expr_perf"
harness = false

[[bench]]
name = "manifold_hce_validation"
harness = false

[[bench]]
name = "nnue_training_suite"
harness = false

[[bench]]
name = "generated_kernels"
harness = false

[[example]]
name = "collect_benchmark_costs"
required-features = ["training"]

[[example]]
name = "train_cost_model"
required-features = ["training"]

[[example]]
name = "gen_egraph_variants"
required-features = ["training"]

[[example]]
name = "guided_training"
required-features = ["training"]
